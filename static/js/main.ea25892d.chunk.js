(this["webpackJsonpflow-forms"]=this["webpackJsonpflow-forms"]||[]).push([[0],[,,,,function(e,t,n){e.exports={logo:"Header_logo__1_msB",logoIcon:"Header_logoIcon__c47Hc",title:"Header_title__2VpMf",headerPanel:"Header_headerPanel__3TNwh",itemsContainer:"Header_itemsContainer__Wdp3U",headerItemLabel:"Header_headerItemLabel__1jLLQ",headerItem:"Header_headerItem__23q8M"}},function(e,t,n){e.exports={sidePanel:"Sidepanel_sidePanel__3a658",sidePanelLabel:"Sidepanel_sidePanelLabel__1ZEtV",sidePanelTextInput:"Sidepanel_sidePanelTextInput__2HnYh",panelBtn:"Sidepanel_panelBtn__3H8fA",deleteBtn:"Sidepanel_deleteBtn__e2VaB Sidepanel_panelBtn__3H8fA",iconBtn:"Sidepanel_iconBtn___qr-z",answerWrapper:"Sidepanel_answerWrapper__2a6EB",answerHeader:"Sidepanel_answerHeader__QkmT8"}},function(e,t,n){e.exports={app:"App_app__1kX79",flowWrapper:"App_flowWrapper__39H7h",fileInput:"App_fileInput__OeFCF",backdrop:"App_backdrop__1J_fz",backdropElementWrapper:"App_backdropElementWrapper__Jj-rr",backdropRemoveBtn:"App_backdropRemoveBtn__2m8Ct",backdropHeader:"App_backdropHeader__28V_f",backdropMain:"App_backdropMain__2R1nr",controls:"App_controls__14oJX",customControlBtn:"App_customControlBtn__3XnkQ",controlStartIcon:"App_controlStartIcon__EY1MC",controlsQuestionIcon:"App_controlsQuestionIcon__2Qw4v",controlsEndIcon:"App_controlsEndIcon__2HrRA"}},,,,function(e,t,n){e.exports={formWrapper:"Form_formWrapper__2N2X-",questionWrapper:"Form_questionWrapper__1qGAg",questionText:"Form_questionText__16sDA",answer:"Form_answer__2uEds",selected:"Form_selected__Q6STM",endWrapper:"Form_endWrapper__1VwxS",endTitle:"Form_endTitle__sS77_",endResult:"Form_endResult__1iDh0"}},function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,s){function o(e){try{i(a.next(e))}catch(t){s(t)}}function c(e){try{i(a.throw(e))}catch(t){s(t)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,c)}i((a=a.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function c(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&s[0]?a.return:s[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(c){s=[6,c],a=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};t.__esModule=!0;var s=n(3);t.vectorAdd=function(e,t){return{x:e.x+t.x,y:e.y+t.y}},t.parseToGraph=function(e){for(var t=null,n={startId:"",nodeMap:{}},a=0,r=e;a<r.length;a++){var o=r[a];s.isNode(o)&&("input"===o.type?t=o.id:"question"===o.type?n.nodeMap[o.id]={type:"question",question:o.data.question,answers:o.data.answers.map((function(e){return{text:e.text,nextId:null}}))}:"end"===o.type&&(n.nodeMap[o.id]={type:"end",result:o.data.result}))}null===t&&console.log("There is no start node");for(var c=0,i=e;c<i.length;c++){o=i[c];s.isEdge(o)&&(o.source===t?n.startId=o.target:n.nodeMap[o.source].answers[parseInt(o.sourceHandle,10)].nextId=o.target)}return n},t.download=function(e,t,n){var a=document.createElement("a"),r=new Blob([e],{type:n});a.href=URL.createObjectURL(r),a.download=t,a.click()},t.fileToJSON=function(e){return a(this,void 0,void 0,(function(){return r(this,(function(t){return[2,new Promise((function(t,n){var a=new FileReader;a.onload=function(e){return t(JSON.parse(e.target.result))},a.onerror=function(e){return n(e)},a.readAsText(e)}))]}))}))}},function(e,t,n){e.exports={questionNodeWrapper:"Questionnode_questionNodeWrapper__1H-8v",selected:"Questionnode_selected___BzoX",questionWrapper:"Questionnode_questionWrapper__2MD59",questionHandle:"Questionnode_questionHandle__2gcb5",questionNodeText:"Questionnode_questionNodeText__1Z2Rj",answerWrapper:"Questionnode_answerWrapper__M-V40",answerText:"Questionnode_answerText__2NCQw",answerList:"Questionnode_answerList__1vg8X"}},,,,function(e,t,n){e.exports={wrapper:"Endnode_wrapper__2tmgF",selected:"Endnode_selected__2hW_g",resultText:"Endnode_resultText__DyQCT"}},,,,,,function(e,t,n){},,,,,,,,function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(13),o=n.n(s),c=(n(22),n(21)),i=n(8),l=n.n(i),d=n(15),u=n(7),p=n(3),j=n(6),b=n.n(j),f=n(2);function x(e){var t=e.id,n=e.sourceX,r=e.sourceY,s=e.targetX,o=e.targetY,c=e.sourcePosition,i=e.targetPosition,l=e.style,d=void 0===l?{}:l,j=(e.data,e.arrowHeadType),b=e.markerEndId,x=Object(a.useContext)(Q),m=Object(p.getBezierPath)({sourceX:n,sourceY:r,sourcePosition:c,targetX:s,targetY:o,targetPosition:i}),h=Object(p.getMarkerEnd)(j,b),_=Object(p.getEdgeCenter)({sourceX:n,sourceY:r,targetX:s,targetY:o}),O=Object(u.a)(_,2),v=O[0],N=O[1];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("path",{id:t,style:d,className:"react-flow__edge-path",d:m,markerEnd:h}),Object(f.jsx)("foreignObject",{width:40,height:40,x:v-20,y:N-20,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml",children:Object(f.jsx)("button",{className:"edgebutton",onClick:function(e){return function(e,t){e.stopPropagation(),console.log("remove ".concat(t)),x(t)}(e,t)},children:"X"})})]})}var m,h=n(4),_=n.n(h),O=n(9),v=n(23),N=function(e){return Object(f.jsxs)("div",{className:_.a.headerPanel,children:[Object(f.jsxs)("div",{className:_.a.logo,children:[Object(f.jsx)(v.a,{className:_.a.logoIcon}),Object(f.jsx)("input",{onChange:function(t){e.setTitle(t.target.value)},value:e.title,className:_.a.title})]}),Object(f.jsxs)("div",{className:_.a.itemsContainer,children:[Object(f.jsxs)("div",{className:_.a.headerItem,onClick:function(){return e.createNode(m.Start)},children:[Object(f.jsx)("div",{className:_.a.headerItemLabel,children:"Start Node"}),Object(f.jsx)(O.d,{})]}),Object(f.jsxs)("div",{className:_.a.headerItem,onClick:function(){return e.createNode(m.Question)},children:[Object(f.jsx)("div",{className:_.a.headerItemLabel,children:"Question Node"}),Object(f.jsx)(O.e,{})]}),Object(f.jsxs)("div",{className:_.a.headerItem,onClick:function(){return e.createNode(m.End)},children:[Object(f.jsx)("div",{className:_.a.headerItemLabel,children:"End Node"}),Object(f.jsx)(O.c,{})]}),Object(f.jsxs)("div",{className:_.a.headerItem,onClick:function(){return e.onExport()},children:[Object(f.jsx)("div",{className:_.a.headerItemLabel,children:"Export"}),Object(f.jsx)(O.b,{})]}),Object(f.jsxs)("div",{className:_.a.headerItem,onClick:function(){return e.onSave()},children:[Object(f.jsx)("div",{className:_.a.headerItemLabel,children:"Save"}),Object(f.jsx)(O.g,{})]}),Object(f.jsxs)("div",{className:_.a.headerItem,onClick:function(){return e.onLoadSave()},children:[Object(f.jsx)("div",{className:_.a.headerItemLabel,children:"Upload Save"}),Object(f.jsx)(O.a,{})]}),Object(f.jsxs)("div",{className:_.a.headerItem,onClick:function(){return e.onTestForm()},children:[Object(f.jsx)("div",{className:_.a.headerItemLabel,children:"Test Form"}),Object(f.jsx)(O.f,{})]})]})]})},w=n(11),g=n(12),y=n.n(g),k=function(e){var t=Object(a.useContext)(F),n="".concat(y.a.questionNodeWrapper);t===e.id&&(n="".concat(y.a.questionNodeWrapper," ").concat(y.a.selected));var r=function(t){var n=100/(e.data.answers.length+1);return n*(t+1)+.5*n};return Object(f.jsxs)("div",{className:n,children:[Object(f.jsxs)("div",{className:y.a.questionWrapper,children:[Object(f.jsx)(p.Handle,{className:"handleLeft",style:{position:"absolute"},type:"target",position:p.Position.Left}),Object(f.jsx)("div",{className:y.a.questionNodeText,children:e.data.question})]}),Object(f.jsx)("div",{className:y.a.answerList,children:e.data.answers.map((function(e,t){return Object(f.jsxs)("div",{className:y.a.answerWrapper,children:[Object(f.jsx)("div",{className:y.a.answerText,children:e.text}),Object(f.jsx)(p.Handle,{id:"".concat(t),className:"handleRight",style:{position:"absolute",top:"".concat(r(t).toString(),"%")},type:"source",position:p.Position.Right})]},t)}))})]})},S=n(18),C=n(5),I=n.n(C),T=function(e){var t;return null==e.nodeData?Object(f.jsx)("div",{className:I.a.sidePanel,children:"Click a node to edit it."}):"question"===e.nodeData.type?Object(f.jsxs)("div",{className:I.a.sidePanel,children:[Object(f.jsx)("div",{className:I.a.sidePanelLabel,children:"Question"}),Object(f.jsx)("textarea",{rows:7,className:I.a.sidePanelTextInput,onChange:function(t){return function(t){var n=e.nodeData;n.data.question=t,e.setNodeData(n)}(t.target.value)},value:e.nodeData.data.question}),(t=e.nodeData.data.answers,t.map((function(t,n){return Object(f.jsxs)("div",{className:I.a.answerWrapper,children:[Object(f.jsxs)("div",{className:I.a.answerHeader,children:[Object(f.jsx)("div",{className:I.a.sidePanelLabel,children:"Answer ".concat(n+1)}),Object(f.jsx)(S.a,{onClick:function(){return function(t){var n=e.nodeData;n.data.answers.splice(t,1),e.setNodeData(n)}(n)},className:I.a.iconBtn})]}),Object(f.jsx)("textarea",{rows:7,className:I.a.sidePanelTextInput,value:t.text,onChange:function(t){return function(t,n){var a=e.nodeData;a.data.answers[n].text=t,e.setNodeData(a)}(t.target.value,n)}})]},n)}))),Object(f.jsx)("button",{onClick:function(){var t=e.nodeData;t.data.answers.push({text:"My answer",nextId:null}),e.setNodeData(t)},className:I.a.panelBtn,children:"Add Answer"}),Object(f.jsx)("button",{onClick:function(t){return e.deleteNode()},className:I.a.deleteBtn,children:"Delete Node"})]}):"end"===e.nodeData.type?Object(f.jsxs)("div",{className:I.a.sidePanel,children:[Object(f.jsx)("div",{className:I.a.sidePanelLabel,children:"Result"}),Object(f.jsx)("textarea",{rows:7,className:I.a.sidePanelTextInput,onChange:function(t){return function(t){var n=e.nodeData;n.data.result=t,e.setNodeData(n)}(t.target.value)},value:e.nodeData.data.result}),Object(f.jsx)("button",{onClick:function(t){return e.deleteNode()},className:I.a.deleteBtn,children:"Delete Node"})]}):"input"===e.nodeData.type?Object(f.jsxs)("div",{className:I.a.sidePanel,children:[Object(f.jsx)("div",{className:I.a.sidePanelLabel,children:"Start node"}),Object(f.jsx)("button",{onClick:function(t){return e.deleteNode()},className:I.a.deleteBtn,children:"Delete Node"})]}):Object(f.jsx)("div",{className:I.a.sidePanel,children:JSON.stringify(e.nodeData,null,1)})},E=n(16),q=n.n(E),D=function(e){var t=Object(a.useContext)(F),n="".concat(q.a.wrapper);return t===e.id&&(n="".concat(q.a.wrapper," ").concat(q.a.selected)),Object(f.jsxs)("div",{className:n,children:[Object(f.jsx)(p.Handle,{className:"handleLeft",style:{position:"absolute"},type:"target",position:p.Position.Left}),Object(f.jsx)("div",{className:q.a.resultText,children:e.data.result})]})},A=n(17),P=n(10),B=n.n(P),L=function(e){return Object(f.jsxs)("div",{className:B.a.questionWrapper,children:[Object(f.jsx)("div",{className:B.a.questionText,children:e.question}),e.answers.map((function(t,n){return Object(f.jsx)(W,{text:t.text,index:n,selectedAns:e.selectedAns,setSelectedAns:e.setSelectedAns},n)}))]})},W=function(e){var t=function(){e.selectedAns===e.index?e.setSelectedAns(null):e.setSelectedAns(e.index)};return e.selectedAns===e.index?Object(f.jsx)("div",{onClick:t,className:"".concat(B.a.answer," ").concat(B.a.selected),children:e.text}):Object(f.jsx)("div",{onClick:t,className:B.a.answer,children:e.text})},H=function(e){var t,n=Object(a.useState)([]),r=Object(u.a)(n,2),s=r[0],o=r[1],c=Object(a.useState)({}),i=Object(u.a)(c,2),l=i[0],d=i[1];if(!(e.formData.startId in e.formData.nodeMap))return Object(f.jsx)("div",{className:B.a.formWrapper,children:"Your form must have a valid start node"});0===s.length&&(t=e.formData.startId,o(s.concat([t])));return Object(f.jsx)("div",{className:B.a.formWrapper,children:s.map((function(t,n){var a,r=e.formData.nodeMap[t];return null==r?null:"question"===r.type?Object(f.jsx)(L,{question:"".concat(n+1,") ").concat(r.question),answers:r.answers,selectedAns:null!==(a=l[t])&&void 0!==a?a:null,setSelectedAns:function(n){return function(t,n){var a=Object.assign({},l);a[t]=n;var r,c=[],i=!1,u=Object(A.a)(s);try{for(u.s();!(r=u.n()).done;){var p=r.value;i?a[p]=null:c.push(p),t===p&&(i=!0)}}catch(j){u.e(j)}finally{u.f()}null!==n&&c.push(e.formData.nodeMap[t].answers[n].nextId),o(c),d(a)}(t,n)}},n):"end"===r.type?Object(f.jsxs)("div",{className:B.a.endWrapper,children:[Object(f.jsx)("div",{className:B.a.endTitle,children:"Results"}),Object(f.jsx)("div",{className:B.a.endResult,children:r.result})]},n):null}))})},M=n.p+"static/media/form.75b7c2c1.txt";!function(e){e[e.Start=0]="Start",e[e.Question=1]="Question",e[e.End=2]="End"}(m||(m={}));var Q=r.a.createContext((function(e){})),F=r.a.createContext("");var R=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)("My Calculator"),o=Object(u.a)(s,2),i=o[0],j=o[1],h=Object(a.useState)({x:300,y:300}),_=Object(u.a)(h,2),v=_[0],g=_[1],y=Object(a.useState)(!1),C=Object(u.a)(y,2),I=C[0],E=C[1],q=Object(a.useRef)(null),A=Object(a.useState)(""),P=Object(u.a)(A,2),B=P[0],L=P[1],W=Object(a.useState)([]),R=Object(u.a)(W,2),X=R[0],J=R[1],Y=function(e){switch(e){case m.Start:!function(){var e={id:Date.now().toString(),type:"input",data:{label:"Start Node"},position:v,sourcePosition:"right",className:"startNode"};J(X.concat([e])),g(Object(w.vectorAdd)(e.position,{x:100,y:100}))}();break;case m.Question:!function(){var e={id:Date.now().toString(),type:"question",data:{label:"Question node",question:"My question",answers:[{text:"My Answer"}]},position:v};J(X.concat([e])),g(Object(w.vectorAdd)(e.position,{x:100,y:100}))}();break;case m.End:!function(){var e={id:Date.now().toString(),type:"end",data:{label:"End Node",result:"My Result"},position:v};J(X.concat([e])),g(Object(w.vectorAdd)(e.position,{x:100,y:100}))}();break;default:throw new Error("Invalid type of ".concat(e))}},V=function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(t=q.current)||void 0===t||t.click(),t.onchange=Object(d.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(w.fileToJSON)(t.files[0]);case 3:n=e.sent,J(n.elements),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),alert("Save file is invalid"),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.stringify(Object(w.parseToGraph)(X)),e.next=3,fetch(M);case 3:return n=e.sent,e.next=6,n.text();case 6:a=e.sent,(r=(new DOMParser).parseFromString(a,"text/html")).getElementById("form-json").textContent=t,s=r.documentElement.outerHTML,Object(w.download)(s,"".concat(i.replace(" ","_"),".html"),"text/plain");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=JSON.stringify(n.toObject()),Object(w.download)(t,"".concat(i.replace(" ","_"),".json"),"text/plain");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(f.jsxs)("div",{className:b.a.app,children:[Object(f.jsx)("input",{type:"file",accept:"application/JSON",className:b.a.fileInput,ref:q}),I?Object(f.jsx)("div",{className:b.a.backdrop,children:Object(f.jsxs)("div",{className:b.a.backdropElementWrapper,children:[Object(f.jsx)("div",{className:b.a.backdropHeader,children:Object(f.jsx)(S.b,{className:b.a.backdropRemoveBtn,onClick:function(){return E(!1)}})}),Object(f.jsx)("div",{className:b.a.backdropMain,children:Object(f.jsx)(H,{formData:Object(w.parseToGraph)(X)})})]})}):null,Object(f.jsx)(N,{onTestForm:function(){E(!0)},onLoadSave:V,onSave:G,onExport:z,createNode:Y,title:i,setTitle:j}),Object(f.jsx)(T,{deleteNode:function(){return function(e){var t=X.filter((function(t){return t.id!==e}));t.length!==X.length&&J(t)}(B)},nodeData:function(){var e=X.filter((function(e){return e.id===B}));return 0===e.length?null:e[0]}(),setNodeData:function(e){return function(e,t){var n=X.filter((function(t){return t.id!==e}));n.length!==X.length&&J(n.concat([t]))}(B,e)}}),Object(f.jsx)("div",{className:b.a.flowWrapper,children:Object(f.jsx)(Q.Provider,{value:function(e){J(X.filter((function(t){return t.id!==e})))},children:Object(f.jsx)(F.Provider,{value:B,children:Object(f.jsxs)(p.default,{nodeTypes:{question:k,end:D},edgeTypes:{buttonedge:x},elements:X,onElementClick:function(e,t){g(Object(w.vectorAdd)(t.position,{x:100,y:100})),L(t.id)},onEdgeUpdate:function(e,t){J(Object(p.updateEdge)(e,t,X))},onConnect:function(e){J(Object(p.addEdge)(Object(c.a)(Object(c.a)({},e),{},{type:"buttonedge"}),X))},onLoad:function(e){return r(e)},children:[Object(f.jsx)(p.Background,{variant:p.BackgroundVariant.Dots,gap:24,size:1}),Object(f.jsx)(p.MiniMap,{nodeColor:function(e){switch(e.type){case"input":return"#FCB332";case"question":return"#EB4B64";case"end":return"#6CE063";default:return"#eee"}},nodeStrokeWidth:3}),Object(f.jsxs)(p.Controls,{className:b.a.controls,children:[Object(f.jsx)(p.ControlButton,{onClick:function(){return Y(m.Start)},className:b.a.customControlBtn,children:Object(f.jsx)(O.d,{className:b.a.controlStartIcon})}),Object(f.jsx)(p.ControlButton,{onClick:function(){return Y(m.Question)},className:b.a.customControlBtn,children:Object(f.jsx)(O.e,{className:b.a.controlsQuestionIcon})}),Object(f.jsx)(p.ControlButton,{onClick:function(){return Y(m.End)},className:b.a.customControlBtn,children:Object(f.jsx)(O.c,{className:b.a.controlsEndIcon})})]})]})})})})]})},X=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,31)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),s(e),o(e)}))};o.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(R,{})}),document.getElementById("root")),X()}],[[30,1,2]]]);
//# sourceMappingURL=main.ea25892d.chunk.js.map